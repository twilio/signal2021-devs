// This works because of a workaround inside the inner workings of `LocalDevelopmentServer`. 
// The goal is to provide a better experience which is tracked in the following issue:
// https://github.com/twilio-labs/serverless-toolkit/issues/346

const actualTwilio = require('../../../../node_modules/twilio/index');
const { MockHttpClient } = require('../../MockHttpClient');

function interceptedTwilio(username, password, options) {
  const client = actualTwilio(username, password, {...options, httpClient: new MockHttpClient()})
  return client;
}

function fakeTwilio(...args) {
  return interceptedTwilio(...args);
}

fakeTwilio.twiml = actualTwilio.twiml;
fakeTwilio.jwt = actualTwilio.jwt;
fakeTwilio.RequestClient = actualTwilio.RequestClient;
fakeTwilio.Twilio = interceptedTwilio;

module.exports = fakeTwilio;